<div *ngIf="loading">Loading person...</div>
<div *ngIf="error" class="error">Error: {{ error }}</div>
<div *ngIf="errorSummary && errorSummary.length" class="error">
  <div *ngFor="let e of errorSummary">{{ e }}</div>
</div>
<form [formGroup]="form" *ngIf="!loading" (ngSubmit)="save()" novalidate>
  <div>
    <label for="name">Name</label>
    <input id="name" formControlName="name" [disabled]="saving" aria-required="true" />
    <div *ngIf="f.name.touched && f.name.invalid" class="field-error">
      <div *ngIf="f.name.errors?.required">Name is required.</div>
      <div *ngIf="f.name.errors?.server">{{ f.name.errors.server }}</div>
    </div>
  </div>

  <div>
    <label for="age">Age</label>
    <input id="age" formControlName="age" inputmode="numeric" [disabled]="saving" />
    <div *ngIf="f.age.touched && f.age.invalid" class="field-error">
      <div *ngIf="f.age.errors?.required">Age is required.</div>
      <div *ngIf="f.age.errors?.pattern">Age must be digits only.</div>
      <div *ngIf="f.age.errors?.server">{{ f.age.errors.server }}</div>
    </div>
  </div>

  <div>
    <label for="gender">Gender</label>
    <select id="gender" formControlName="gender" [disabled]="saving">
      <option value="">-- select --</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
      <option value="Other">Other</option>
    </select>
    <div *ngIf="f.gender.touched && f.gender.invalid" class="field-error">
      <div>Gender must be Male, Female, or Other.</div>
    </div>
  </div>

  <div>
    <label for="mobile">Mobile</label>
    <input id="mobile" formControlName="mobile" inputmode="tel" [disabled]="saving" />
    <div *ngIf="f.mobile.touched && f.mobile.invalid" class="field-error">
      <div *ngIf="f.mobile.errors?.pattern">Mobile must be 7-15 digits, optional leading +.</div>
      <div *ngIf="f.mobile.errors?.server">{{ f.mobile.errors.server }}</div>
    </div>
  </div>

  <button type="submit" [disabled]="saving">{{ saving ? 'Saving...' : 'Save' }}</button>
</form>
